# -*- coding: utf-8 -*-
"""clahe_enhance

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1NLuOFDUQYyNejbR-O_uGTgTHq-RMP959
"""

# -*- coding: utf-8 -*-
import cv2
import numpy as np

def apply_clahe(img_bgr: np.ndarray, clip_limit: float = 2.0, tile_grid_size=(8, 8)) -> np.ndarray:
    """
    Aplica CLAHE en el canal L del espacio LAB y devuelve BGR.
    - img_bgr: imagen en formato BGR (cv2.imread)
    - clip_limit: contraste límite para CLAHE
    - tile_grid_size: tamaño de mosaico (tupla)
    """
    if img_bgr is None:
        raise ValueError("Imagen vacía o no cargada.")

    lab = cv2.cvtColor(img_bgr, cv2.COLOR_BGR2LAB)
    l, a, b = cv2.split(lab)

    clahe = cv2.createCLAHE(clipLimit=clip_limit, tileGridSize=tile_grid_size)
    l_eq = clahe.apply(l)

    lab_eq = cv2.merge((l_eq, a, b))
    bgr_eq = cv2.cvtColor(lab_eq, cv2.COLOR_LAB2BGR)
    return bgr_eq