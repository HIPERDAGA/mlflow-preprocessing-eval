# -*- coding: utf-8 -*-
"""dataset_loader

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1NLuOFDUQYyNejbR-O_uGTgTHq-RMP959
"""

# -*- coding: utf-8 -*-
import os
import cv2
import numpy as np
from typing import List

IMG_EXTS = {".jpg", ".jpeg", ".png", ".bmp", ".tif", ".tiff", ".webp"}

def list_images(folder: str) -> list:
    files = []
    for name in sorted(os.listdir(folder)):
        ext = os.path.splitext(name)[1].lower()
        if ext in IMG_EXTS:
            files.append(os.path.join(folder, name))
    return files

def load_images_bgr(folder: str) -> List[np.ndarray]:
    """
    Carga imágenes en BGR (como cv2.imread).
    """
    paths = list_images(folder)
    imgs = []
    for p in paths:
        img = cv2.imread(p, cv2.IMREAD_COLOR)
        if img is not None:
            imgs.append(img)
    if not imgs:
        raise ValueError(f"No se encontraron imágenes válidas en: {folder}")
    return imgs

def bgr_to_rgb(img_bgr: np.ndarray) -> np.ndarray:
    return cv2.cvtColor(img_bgr, cv2.COLOR_BGR2RGB)